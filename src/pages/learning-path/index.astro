---
import MainLayout from '../../layouts/MainLayout.astro';
import PageTitle from '../../components/PageTitle.astro';
import { modules } from '../../data/modules';

// Helper function to get module count for courses in a learning path
function getModuleCountForCourses(courseIds: string[]): number {
  return modules.filter(m => courseIds.includes(m.courseId)).length;
}

const learningPaths = [
	{
		id: 'frontend',
		title: 'Frontend',
		description: 'Master frontend development from HTML to React',
		courses: [
			{ id: 'html-css-tailwind', name: 'HTML & CSS', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/html/html.png' },
			{ id: 'javascript-core', name: 'JavaScript', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/javascript/javascript.png' },
			{ id: 'react', name: 'React', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/react/react.png' }
		],
		borderColor: 'border-primary-400',
		bgGradient: 'from-orange-50 via-yellow-50 to-cyan-50',
		accentColor: 'bg-primary-100 text-primary-700 border-primary-300',
		hoverColor: 'group-hover:text-primary-700',
		arrowColor: 'text-primary-600',
		get moduleCount() { return getModuleCountForCourses(this.courses.map(c => c.id)); },
	},
	{
		id: 'backend',
		title: 'Backend',
		description: 'Build APIs and servers: Node.js → Databases → Auth & Security',
		courses: [
			{ id: 'node-express', name: 'Node.js & Express', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/nodejs/nodejs.png' },
			{ id: 'databases', name: 'Databases & SQL', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/postgresql/postgresql.png' },
			{ id: 'auth-security', name: 'Backend Advanced', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/docker/docker.png' }
		],
		borderColor: 'border-green-500',
		bgGradient: 'from-green-50 via-blue-50 to-red-50',
		accentColor: 'bg-green-100 text-green-700 border-green-300',
		hoverColor: 'group-hover:text-green-700',
		arrowColor: 'text-green-600',
		get moduleCount() { return getModuleCountForCourses(this.courses.map(c => c.id)); },
	},
	{
		id: 'web-fundamentals',
		title: 'Web Fundamentals',
		description: 'Master the essentials: Terminal → HTTP & DevTools → Git',
		courses: [
			{ id: 'internet-tools', name: 'Internet & Tools', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/terminal/terminal.png' },
			{ id: 'git-mastery', name: 'Git', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/git/git.png' },
			{ id: 'javascript-core', name: 'JavaScript', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/javascript/javascript.png' }
		],
		borderColor: 'border-gray-500',
		bgGradient: 'from-gray-50 via-cyan-50 to-orange-50',
		accentColor: 'bg-gray-200 text-gray-700 border-gray-400',
		hoverColor: 'group-hover:text-gray-700',
		arrowColor: 'text-gray-600',
		get moduleCount() { return getModuleCountForCourses(this.courses.map(c => c.id)); },
	},
	{
		id: 'fullstack',
		title: 'Fullstack',
		description: 'Master fullstack development with Next.js: Frontend + Backend in one codebase',
		courses: [
			{ id: 'nextjs', name: 'Next.js', logo: 'https://raw.githubusercontent.com/github/explore/main/topics/nextjs/nextjs.png' }
		],
		borderColor: 'border-gray-700',
		bgGradient: 'from-gray-100 via-gray-50 to-zinc-50',
		accentColor: 'bg-gray-700 text-white border-gray-800',
		hoverColor: 'group-hover:text-gray-800',
		arrowColor: 'text-gray-700',
		get moduleCount() { return getModuleCountForCourses(this.courses.map(c => c.id)); },
	},
];
---

<MainLayout title="Learning Paths - Guided Progressions">
	<div class="page-enter">
		<!-- Header -->
		<div class="mb-8">
			<PageTitle>
				<h1 slot="title" class="text-2xl font-black text-gray-900 uppercase">Learning Paths</h1>
			</PageTitle>
			<p class="text-gray-600 mt-2">Structured multi-course progressions to master complete skill sets</p>
		</div>

		<!-- Link to Courses -->
		<a href="/courses" class="group mb-8 flex items-center gap-3 p-3 rounded-lg border border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm transition-all">
			<div class="w-8 h-8 rounded-md bg-gray-100 flex items-center justify-center flex-shrink-0">
				<svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
				</svg>
			</div>
			<div class="flex-1 min-w-0">
				<div class="flex items-center gap-2">
					<h2 class="text-sm font-medium text-gray-800 group-hover:text-gray-900 transition-colors">Browse individual courses</h2>
					<svg class="w-3 h-3 text-gray-400 group-hover:text-gray-600 group-hover:translate-x-0.5 transition-all" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
					</svg>
				</div>
				<p class="text-[11px] text-gray-500 truncate">Learn specific technologies at your own pace</p>
			</div>
		</a>

		<!-- Learning Paths -->
		<div class="space-y-4 mb-8">
			{learningPaths.map((path) => (
				<a href={`/learning-path/${path.id}`} class={`block p-5 border-2 border-gray-200 rounded-lg bg-gradient-to-r ${path.bgGradient} hover:border-gray-300 hover:shadow-lg transition-all group relative overflow-hidden`}>
					<div class="absolute top-0 right-0 w-32 h-32 bg-white rounded-full -mr-16 -mt-16 opacity-30 group-hover:scale-150 transition-transform duration-500"></div>
					<div class="relative z-10">
						<div class="flex items-start justify-between gap-4">
							<div class="flex-1 min-w-0">
								<div class="flex items-center gap-2 mb-0.5">
									<h2 class={`font-bold text-lg text-gray-900 ${path.hoverColor} transition-colors`}>{path.title} Learning Path</h2>
									<span class={`text-[10px] px-2 py-0.5 rounded border uppercase font-bold ${path.accentColor}`}>Guided Path</span>
								</div>
								<p class="text-xs text-gray-600 mb-3">{path.description}</p>
								
								<!-- Courses list -->
								<div class="flex flex-wrap gap-2 mb-3">
									{path.courses.map((course, idx) => (
										<div class="flex items-center gap-1.5 bg-white/70 border border-gray-200/50 rounded-md px-2 py-1.5 hover:bg-white transition-colors">
											<img src={course.logo} alt={course.name} class="w-4 h-4 object-contain" />
											<span class="text-[11px] font-medium text-gray-700">{course.name}</span>
											{idx < path.courses.length - 1 && (
												<svg class="w-3 h-3 text-gray-400 ml-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
													<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
												</svg>
											)}
										</div>
									))}
								</div>
								
								<p class="text-[10px] text-gray-500">{path.courses.length} courses &middot; {path.moduleCount} modules</p>
							</div>
							<span class={`${path.arrowColor} font-bold text-lg group-hover:translate-x-1 transition-transform flex-shrink-0 mt-1`}>&rarr;</span>
						</div>
					</div>
				</a>
			))}
		</div>

		<!-- Method Section -->
		<div class="border-2 border-gray-300 rounded-lg p-6 bg-white">
			<div class="mb-4">
				<h2 class="font-bold text-sm uppercase text-gray-700 inline">Why Learning Paths?</h2>
				<span class="inline-block w-8 h-0.5 bg-primary-500 ml-2 align-middle" />
			</div>

			<div class="grid md:grid-cols-3 gap-6">
				<div>
					<div class="flex items-center gap-2 mb-2">
						<div class="w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center">
							<span class="text-primary-600 font-bold text-sm">1</span>
						</div>
						<h3 class="font-bold text-gray-900 text-sm">Structured Progression</h3>
					</div>
					<p class="text-xs text-gray-600 ml-10">Learn in the right order. Each course builds on the previous one.</p>
				</div>

				<div>
					<div class="flex items-center gap-2 mb-2">
						<div class="w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center">
							<span class="text-primary-600 font-bold text-sm">2</span>
						</div>
						<h3 class="font-bold text-gray-900 text-sm">Complete Skill Set</h3>
					</div>
					<p class="text-xs text-gray-600 ml-10">Master everything you need for a specific role or domain.</p>
				</div>

				<div>
					<div class="flex items-center gap-2 mb-2">
						<div class="w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center">
							<span class="text-primary-600 font-bold text-sm">3</span>
						</div>
						<h3 class="font-bold text-gray-900 text-sm">Track Progress</h3>
					</div>
					<p class="text-xs text-gray-600 ml-10">See your advancement across all courses in the path.</p>
				</div>
			</div>
		</div>
	</div>
</MainLayout>
