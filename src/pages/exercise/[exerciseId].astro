---
import MainLayout from '../../layouts/MainLayout.astro';
import ExercisePage from '../../pages/_ExercisePage';
import { exercises, getExercise, getModule, getLesson } from '../../data/modules';
import { getLearningPathTitles } from '../../data/course-metadata';

const learningPathTitles = getLearningPathTitles();

export const prerender = true;

export function getStaticPaths() {
  return exercises.map(exercise => ({
    params: { exerciseId: exercise.id },
  }));
}

const { exerciseId } = Astro.params;
const exercise = exerciseId ? getExercise(exerciseId) : undefined;
const lesson = exercise ? getLesson(exercise.lessonId) : undefined;
const module = exercise ? getModule(exercise.moduleId) : undefined;
const pathTitle = module ? learningPathTitles[module.courseId] || module.courseId : '';
const pageTitle = pathTitle && lesson ? `${pathTitle} - ${lesson.title}` : `Exercise - ${exerciseId}`;
---

<MainLayout title={pageTitle}>
	<ExercisePage client:load exerciseId={exerciseId} />
</MainLayout>
