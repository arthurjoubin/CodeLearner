---
import MainLayout from '../layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import { ArrowRight, Newspaper, Command, Brain, Tag } from 'lucide-react';

const news = (await getCollection('news')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const latestNews = news.slice(0, 3);

const devfinds = (await getCollection('devfinds')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const tools = await getCollection('tools');
const llms = await getCollection('llms');

function formatDate(date: Date) {
	return date.toLocaleDateString('en-US', {
		day: 'numeric',
		month: 'short',
		year: 'numeric'
	});
}
---

<MainLayout title="Resources">
	<div class="page-enter max-w-5xl mx-auto">
		<div class="mb-6">
			<div class="relative inline-block">
				<h1 class="text-xl font-black text-gray-900 uppercase">Resources</h1>
				<span class="absolute -bottom-0.5 left-0 w-12 h-0.5 bg-primary-500" />
			</div>
			<p class="text-sm text-gray-500 mt-1">AI news, tools, and Dev Finds</p>
		</div>

		<div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-8">
			<a
				href="/resources/news"
				class="group p-4 bg-white border-2 border-gray-300 rounded-lg hover:border-gray-900 transition-all"
			>
				<div class="flex items-center gap-3">
					<span class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
						<Newspaper class="w-5 h-5 text-gray-700" />
					</span>
					<div class="flex-1">
						<h3 class="font-bold text-gray-900 text-sm uppercase">Latest News</h3>
						<p class="text-xs text-gray-500">{news.length} articles</p>
					</div>
					<ArrowRight class="w-4 h-4 text-gray-400 group-hover:text-gray-900 group-hover:translate-x-1 transition-all" />
				</div>
			</a>

			<a
				href="/resources/tools"
				class="group p-4 bg-white border-2 border-gray-300 rounded-lg hover:border-gray-900 transition-all"
			>
				<div class="flex items-center gap-3">
					<span class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
						<Command class="w-5 h-5 text-gray-700" />
					</span>
					<div class="flex-1">
						<h3 class="font-bold text-gray-900 text-sm uppercase">AI Tools</h3>
						<p class="text-xs text-gray-500">{tools.length} tools</p>
					</div>
					<ArrowRight class="w-4 h-4 text-gray-400 group-hover:text-gray-900 group-hover:translate-x-1 transition-all" />
				</div>
			</a>

			<a
				href="/resources/llms"
				class="group p-4 bg-white border-2 border-gray-300 rounded-lg hover:border-gray-900 transition-all"
			>
				<div class="flex items-center gap-3">
					<span class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
						<Brain class="w-5 h-5 text-gray-700" />
					</span>
					<div class="flex-1">
						<h3 class="font-bold text-gray-900 text-sm uppercase">LLM Models</h3>
						<p class="text-xs text-gray-500">{llms.length} models</p>
					</div>
					<ArrowRight class="w-4 h-4 text-gray-400 group-hover:text-gray-900 group-hover:translate-x-1 transition-all" />
				</div>
			</a>

			<a
				href="/resources/devfinds"
				class="group p-4 bg-white border-2 border-gray-300 rounded-lg hover:border-gray-900 transition-all"
			>
				<div class="flex items-center gap-3">
					<span class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
						<Tag class="w-5 h-5 text-gray-700" />
					</span>
					<div class="flex-1">
						<h3 class="font-bold text-gray-900 text-sm uppercase">Dev Finds</h3>
						<p class="text-xs text-gray-500">{devfinds.length} active</p>
					</div>
					<ArrowRight class="w-4 h-4 text-gray-400 group-hover:text-gray-900 group-hover:translate-x-1 transition-all" />
				</div>
			</a>
		</div>

		<div class="mb-8">
			<div class="flex items-center justify-between mb-4">
				<div class="relative inline-block">
					<h2 class="font-bold text-gray-900 text-sm uppercase">Latest News</h2>
					<span class="absolute -bottom-0.5 left-0 w-10 h-0.5 bg-primary-500" />
				</div>
				<a href="/resources/news" class="text-xs font-bold uppercase text-primary-600 hover:text-primary-700 transition-colors flex items-center gap-1">
					View all
					<ArrowRight class="w-3 h-3" />
				</a>
			</div>
			
			<div class="space-y-3">
				{latestNews.map((article) => (
					<article class="group p-4 bg-white border-2 border-gray-300 rounded-lg hover:border-gray-900 transition-all">
						<div class="flex items-start gap-4">
							<div class="flex-1 min-w-0">
								<div class="flex items-center gap-2 mb-1.5">
									<span class="text-[10px] px-2 py-0.5 bg-gray-100 text-gray-600 rounded font-bold uppercase">
										{article.data.tags[0]}
									</span>
									<span class="text-[10px] text-gray-400">{formatDate(article.data.pubDate)}</span>
								</div>
								
								<a href={`/resources/news/${article.slug}`}>
									<h3 class="font-bold text-gray-900 group-hover:text-primary-600 transition-colors text-sm line-clamp-1">
										{article.data.title}
									</h3>
								</a>
								
								<p class="text-xs text-gray-500 mt-1 line-clamp-1">{article.data.description}</p>
							</div>
							<ArrowRight class="w-4 h-4 text-gray-400 group-hover:text-gray-900 group-hover:translate-x-1 transition-all flex-shrink-0 mt-1" />
						</div>
					</article>
				))}
			</div>
		</div>
	</div>
</MainLayout>

<style>
	.line-clamp-1 {
		display: -webkit-box;
		-webkit-line-clamp: 1;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
</style>
